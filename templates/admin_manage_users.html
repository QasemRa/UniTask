{% extends 'base.html' %}
{% load static %}

{% block title %}Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† - Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©{% endblock %}

{% block content %}
    <header class="header">
        <div class="header-content">
            <h1>ğŸ“ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© - Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h1>
            <div class="header-user">
                <div class="user-info">
                    <div class="user-avatar">{{ user.username|slice:":1"|upper }}</div>
                    <span>Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ {{ user.get_full_name|default:user.username }}</span>
                </div>
                <a href="{% url 'logout' %}" class="logout-btn">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a>
            </div>
        </div>
    </header>

    <div class="dashboard-layout">
        <aside class="sidebar">
            <ul class="sidebar-menu">
                <li>
                    <a href="{% url 'admin_dashboard' %}">
                        <span class="icon">ğŸ“Š</span>
                        <span>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'admin_add_doctor' %}">
                        <span class="icon">ğŸ‘¨â€ğŸ«</span>
                        <span>Ø¥Ø¶Ø§ÙØ© Ø¯ÙƒØªÙˆØ±</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'admin_add_student' %}">
                        <span class="icon">ğŸ‘¨â€ğŸ“</span>
                        <span>Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'admin_assign_subjects' %}">
                        <span class="icon">ğŸ“š</span>
                        <span>ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ø¯</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'admin_enroll_students' %}">
                        <span class="icon">ğŸ“</span>
                        <span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø·Ù„Ø§Ø¨</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'admin_manage_users' %}" class="active">
                        <span class="icon">ğŸ‘¥</span>
                        <span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</span>
                    </a>
                </li>
            </ul>
        </aside>

        <main class="main-content">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 2rem;">
                <a href="{% url 'admin_dashboard' %}" class="btn btn-outline" style="padding: 0.5rem 1rem;">
                    â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                </a>
                <h1 class="page-title" style="margin-bottom: 0;">ğŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h1>
            </div>

            {% if messages %}
            <div style="margin-bottom: 2rem;">
                {% for message in messages %}
                <div class="alert alert-{{ message.tags }}"
                    style="padding: 1rem; background: {% if message.tags == 'success' %}rgba(76, 175, 80, 0.1){% elif message.tags == 'error' %}rgba(244, 67, 54, 0.1){% else %}rgba(255, 152, 0, 0.1){% endif %}; border-radius: 8px; margin-bottom: 1rem; color: {% if message.tags == 'success' %}#4caf50{% elif message.tags == 'error' %}#f44336{% else %}#ff9800{% endif %};">
                    {{ message }}
                </div>
                {% endfor %}
            </div>
            {% endif %}

            <div class="subjects-section">
                <div class="section-header">
                    <h2 class="section-title">ğŸ‘¨â€ğŸ« Ø§Ù„Ø¯ÙƒØ§ØªØ±Ø©</h2>
                </div>
                
                {% if doctors %}
                <div class="table-container" style="margin-bottom: 2rem;">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ø§Ø³Ù…</th>
                                <th>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</th>
                                <th>Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù…Ø³Ù†Ø¯Ø©</th>
                                <th>Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø³Ø§Ø¨</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for doctor in doctors %}
                            <tr>
                                <td><strong>{{ doctor.get_full_name|default:doctor.username }}</strong></td>
                                <td>{{ doctor.email }}</td>
                                <td>{{ doctor.teaching_subjects.count }}</td>
                                <td>
                                    <span style="padding: 0.25rem 0.5rem; background: rgba(76, 175, 80, 0.1); color: #4caf50; border-radius: 4px; font-size: 0.875rem;">
                                        Ù†Ø´Ø·
                                    </span>
                                </td>
                                <td>
                                    <form method="post" style="display: inline;">
                                        {% csrf_token %}
                                        <input type="hidden" name="user_id" value="{{ doctor.id }}">
                                        <button type="submit" name="action" value="toggle_doctor" 
                                                class="btn-small" 
                                                style="background: var(--warning-orange);">
                                            ØªØ¹Ø·ÙŠÙ„
                                        </button>
                                    </form>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="upload-card">
                    <div style="text-align: center; padding: 2rem; color: #757575;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">ğŸ‘¨â€ğŸ«</div>
                        <h3 style="color: #212121; margin-bottom: 0.5rem;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¯ÙƒØ§ØªØ±Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</h3>
                        <p>Ù‚Ù… Ø¨Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ Ø¯ÙƒØªÙˆØ± Ù„Ù„Ù†Ø¸Ø§Ù….</p>
                    </div>
                </div>
                {% endif %}
            </div>

            <div class="subjects-section">
                <div class="section-header">
                    <h2 class="section-title">ğŸ‘¨â€ğŸ“ Ø§Ù„Ø·Ù„Ø§Ø¨</h2>
                </div>
                
                {% if students %}
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ø§Ø³Ù…</th>
                                <th>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</th>
                                <th>Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†</th>
                                <th>Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ù…Ø±ÙÙˆØ¹Ø©</th>
                                <th>Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø³Ø§Ø¨</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for student in students %}
                            <tr>
                                <td><strong>{{ student.get_full_name|default:student.username }}</strong></td>
                                <td>{{ student.email }}</td>
                                <td>{{ student.enrollments.count }}</td>
                                <td>{{ student.submissions.count }}</td>
                                <td>
                                    <span style="padding: 0.25rem 0.5rem; background: rgba(76, 175, 80, 0.1); color: #4caf50; border-radius: 4px; font-size: 0.875rem;">
                                        Ù†Ø´Ø·
                                    </span>
                                </td>
                                <td>
                                    <form method="post" style="display: inline;">
                                        {% csrf_token %}
                                        <input type="hidden" name="user_id" value="{{ student.id }}">
                                        <button type="submit" name="action" value="toggle_student" 
                                                class="btn-small" 
                                                style="background: var(--warning-orange);">
                                            ØªØ¹Ø·ÙŠÙ„
                                        </button>
                                    </form>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div class="upload-card">
                    <div style="text-align: center; padding: 2rem; color: #757575;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">ğŸ‘¨â€ğŸ“</div>
                        <h3 style="color: #212121; margin-bottom: 0.5rem;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø§Ø¨ Ø­Ø§Ù„ÙŠØ§Ù‹</h3>
                        <p>Ù‚Ù… Ø¨Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ Ø·Ø§Ù„Ø¨ Ù„Ù„Ù†Ø¸Ø§Ù….</p>
                    </div>
                </div>
                {% endif %}
            </div>

        </main>
    </div>
{% endblock %}
